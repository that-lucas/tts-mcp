#!/usr/bin/env bash
#
# Reject commits that use an email other than the project's expected one.
#

EXPECTED_DOMAIN="users.noreply.github.com"
ACTUAL_EMAIL="$(git config user.email)"
ACTUAL_DOMAIN="${ACTUAL_EMAIL#*@}"

if [ "$ACTUAL_DOMAIN" != "$EXPECTED_DOMAIN" ]; then
    echo "ERROR: Committing with wrong email domain."
    echo "  Current:  $ACTUAL_EMAIL"
    echo "  Expected: *@$EXPECTED_DOMAIN"
    echo ""
    echo "Fix with: git config user.email \"<your-id>@$EXPECTED_DOMAIN\""
    exit 1
fi
